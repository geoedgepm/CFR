{% load static %}
{% load i18n %}
{% load jsonify %}

<!DOCTYPE html>
<html lang="en" ng-app="incidentApp">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>CFR</title>

    <!-- Bootstrap -->
    <link href="{% static 'incidents/vendors/bootstrap/dist/css/bootstrap.min.css'%} " rel="stylesheet">
    <!-- Font Awesome -->
    <link href="{% static 'incidents/vendors/font-awesome/css/font-awesome.min.css'%}" rel="stylesheet">
    <!-- NProgress -->
    <link href="{% static 'incidents/vendors/nprogress/nprogress.css'%}" rel="stylesheet">
    <link href="{% static 'incidents/vendors/openlayers/ol.css' %}" rel="stylesheet">
    <!-- Custom Theme Style -->
    <link href="{% static 'incidents/css/custom.css'%}" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'incidents/vendors/fancybox/jquery.fancybox.css'%}" media="screen">

    <script src="{% static 'incidents/vendors/jquery/dist/jquery.min.js'%}"></script>
    <script src="{% static 'incidents/vendors/openlayers/ol.js'%}"></script>
    <script src="{% static 'incidents/vendors/fancybox/jquery.fancybox.js'%}"></script>

    <script src="{% static 'incidents/js/angular/angular.js' %}"></script>
    <script src="{% static 'incidents/js/angular/angular-resource.js' %}"></script>
    <script src="{% static 'incidents/js/angular-cookies/angular-cookies.min.js' %}"></script>
    <script src="{% static 'incidents/js/incident.js' %}"></script>


    <script>
$(document).ready(function(){
    $(".fancybox").fancybox({
        openEffect: "none",
        closeEffect: "none"
    });
});

incident = {'name': '{{ incident.name }}',
            'latitude': '{{ incident.latitude }}',
            'longitude': '{{ incident.longitude }}',
            'disaster_type': '/api/v1/disaster/'+'{{ incident.disaster_type_id }}'+'/',
            'contact_no': '{{ incident.contact_no }}',
            'address': '{{ incident.address }}',
            'synced_date': '{{ incident.synced_date }}',
            'reported_date': '{{ incident.reported_date }}',
            'description': '{{ incident.description }}',
            'district': '{{ incident.district }}',
            'province': '{{ incident.province }}',
            'ds': '{{ incident.ds }}',
            'user': '/api/v1/user/1/'
            };




    </script>
    <style>
.gallery
{
    display: inline-block;
    margin-top: 20px;
}







    </style>
</head>

<body class="nav-md" ng-controller="IncidentAdminController" ng-init="init()">
<div class="container body">
    <div class="main_container">
        <div class="col-md-3 left_col">
            <div class="left_col scroll-view">
                <div class="navbar nav_title" style="border: 0;">
                    <a href="index.html" class="site_title"><i class="fa fa-map-marker"></i> <span>CFR</span></a>
                </div>

                <div class="clearfix"></div>

                <!-- menu profile quick info -->
                <div class="profile">
                    <div class="profile_pic">
                        <img src="{% static 'incidents/img/img.png' %}" alt="..." class="img-circle profile_img">
                    </div>
                    <div class="profile_info">
                        <span>Welcome,</span>
                        <h2>Admin</h2>
                    </div>
                </div>
                <!-- /menu profile quick info -->

                <br/>
                <!-- sidebar menu -->
                <div id="sidebar-menu" class="main_menu_side hidden-print main_menu">
                    <div class="menu_section">
                        <h3 style="color:#898989;">----------------------------------------</h3>
                        <ul class="nav side-menu">
                            <li><a href="index.html"><i class="fa fa-home"></i> Dashboard </a>

                            </li>
                            <li><a href="map.html"><i class="fa fa-edit"></i> Disaster Map </a>

                            </li>
                            <li><a><i class="fa fa-desktop"></i> User Manegment <span class="fa fa-chevron-down"></span></a>
                                <ul class="nav child_menu">
                                    <li><a href="add_user.html">Add User</a></li>
                                    <li><a href="profile.html">Profile</a></li>
                                    <li><a href="user_maneger.html">Manage Users</a></li>

                                </ul>
                            </li>
                            <!--li><a href="add_disaster.html"><i class="fa fa-table"></i> Add Disaster </a-->

                            </li>
                            <li><a href="incedent.html"><i class="fa fa-table"></i> Incedents </a>

                            </li>
                            <li><a href="charts.html"><i class="fa fa-table"></i> Charts </a>

                            </li>


                        </ul>
                    </div>


                </div>
                <!-- /sidebar menu -->


            </div>
        </div>

        <!-- top navigation -->
        <div class="top_nav">
            <div class="nav_menu">
                <nav>
                    <div class="nav toggle">
                        <a id="menu_toggle"><i class="fa fa-bars"></i></a>
                    </div>

                    <ul class="nav navbar-nav navbar-right">
                        <li class="">
                            <a href="javascript:;" class="user-profile dropdown-toggle" data-toggle="dropdown"
                               aria-expanded="false">
                                <img src="{% static 'incidents/img/img.png' %}" alt="">Admin
                                <span class=" fa fa-angle-down"></span>
                            </a>
                            <ul class="dropdown-menu dropdown-usermenu pull-right">
                                <li><a href="javascript:;"> Profile</a></li>

                                <li><a href="javascript:;">Help</a></li>
                                <li><a href="login.html"><i class="fa fa-sign-out pull-right"></i> Log Out</a></li>
                            </ul>
                        </li>

                        <li role="presentation" class="dropdown">
                            <a href="javascript:;" class="dropdown-toggle info-number" data-toggle="dropdown"
                               aria-expanded="false">
                                <i class="fa fa-envelope-o"></i>
                                <span class="badge bg-green">6</span>
                            </a>
                            <ul id="menu1" class="dropdown-menu list-unstyled msg_list" role="menu">
                                <li>
                                    <a>
                                        <span class="image"><img src="{% static 'incidents/img/img.png' %}"
                                                                 alt="Profile Image"/></span>
                        <span>
                          <span>Admin User</span>
                          <span class="time">3 mins ago</span>
                        </span>
                        <span class="message">
                          Lorem Ipsum is simply dummy text of the printing and typesetting industry.
                        </span>
                                    </a>
                                </li>
                                <li>
                                    <a>
                                        <span class="image"><img src="{% static 'incidents/img/img.png' %}"
                                                                 alt="Profile Image"/></span>
                        <span>
                          <span>Admin User</span>
                          <span class="time">3 mins ago</span>
                        </span>
                        <span class="message">
                          Lorem Ipsum is simply dummy text of the printing and typesetting industry.
                        </span>
                                    </a>
                                </li>
                                <li>
                                    <a>
                                        <span class="image"><img src="{% static 'incidents/img/img.png' %}"
                                                                 alt="Profile Image"/></span>
                        <span>
                          <span>Admin User</span>
                          <span class="time">3 mins ago</span>
                        </span>
                        <span class="message">
                          Lorem Ipsum is simply dummy text of the printing and typesetting industry.
                        </span>
                                    </a>
                                </li>
                                <li>
                                    <a>
                                        <span class="image"><img src="{% static 'incidents/img/img.png' %}"
                                                                 alt="Profile Image"/></span>
                        <span>
                          <span>Admin User</span>
                          <span class="time">3 mins ago</span>
                        </span>
                        <span class="message">
                          Lorem Ipsum is simply dummy text of the printing and typesetting industry.
                        </span>
                                    </a>
                                </li>
                                <li>
                                    <div class="text-center">
                                        <a>
                                            <strong>See All Messages</strong>
                                            <i class="fa fa-angle-right"></i>
                                        </a>
                                    </div>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
        <!-- /top navigation -->


        <!-- page content -->
        <div class="right_col" role="main">
            <div class="">


                <div class="clearfix"></div>

                <div class="row">
                    <div class="col-md-12 col-sm-12 col-xs-12">
                        <div class="x_panel">
                            <div class="x_title">
                                <h2>Incedent Report</h2>
                                <ul class="nav navbar-right panel_toolbox">
                                    <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                                    </li>


                                </ul>
                                <div class="clearfix"></div>
                            </div>
                            <div class="x_content">
                                <div class="col-md-8">
                                    <div class="alert alert-success" id="success" role="alert"
                                         style="display:none;margin-top:10px;">
                                        This incident is successfully verified.
                                    </div>

                                    <div class="alert alert-danger" id="danger" role="alert"
                                         style="display:none;margin-top:10px;">
                                        This incident is deleted
                                    </div>
                                    <div class="col-md-3">
                                        <strong>Disaster Type</strong>
                                    </div>
                                    <div class="col-md-9">
                                        {{ incident.disaster_type }}
                                    </div>
                                    <br><br>
                                    <div class="clearfix"></div>
                                    <div class="col-md-3">
                                        <strong>Reporter's Name</strong>
                                    </div>
                                    <div class="col-md-9">
                                        {{ incident.name }}
                                    </div>
                                    <br><br>
                                    <div class="clearfix"></div>
                                    <div class="col-md-3">
                                        <strong>Contact No</strong>
                                    </div>
                                    <div class="col-md-9">
                                        {{ incident.contact_no }}
                                    </div>
                                    <br><br>
                                    <div class="clearfix"></div>
                                    <div class="col-md-3">
                                        <strong>Reported Date/Time</strong>
                                    </div>
                                    <div class="col-md-9">
                                        {{ incident.reported_date }}
                                    </div>
                                    <br><br>
                                    <div class="clearfix"></div>
                                    <div class="col-md-3">
                                        <strong>District</strong>
                                    </div>
                                    <div class="col-md-9">
                                        {{ incident.district }}
                                    </div>
                                    <br><br>
                                    <div class="clearfix"></div>
                                    <div class="col-md-3">
                                        <strong>Description</strong>
                                    </div>
                                    <div class="col-md-9">
                                        {{ incident.description }}
                                    </div>
                                    <!-- list up close-end questions -->
                                    <br><br>
                                    <div class="clearfix"></div>

                                    {% for user_choice in user_choices %}
                                    <div class="col-md-3">
                                        <strong>{{ user_choice.question }}</strong>
                                    </div>
                                    <div class="col-md-9">
                                        {% for answer in user_choice.answers %}
                                        <div class="row">
                                            <div class="col-md-12">
                                                {% if user_choice.field_type == 'text' %}
                                                {{ answer.text_input }}
                                                {% else %}
                                                {{ answer.choice__choice }}
                                                {% endif %}

                                            </div>
                                        </div>
                                        {% endfor %}
                                    </div>
                                    <div class="clearfix"></div>
                                    <br>
                                    {% endfor %}

                                    <br><br>


                                    <div class="row">
                                        {% for photo in incident.photo_set.all %}
                                        <div class='list-group gallery'>
                                            <div class='col-sm-4 col-xs-6 col-md-3 col-lg-3'>
                                                <a class="thumbnail fancybox" rel="ligthbox"
                                                   href="{{ MEDIA_URL }}{{ photo.name.url }}">
                                                    <img class="img-responsive" alt=""
                                                         src="{{ MEDIA_URL }}{{ photo.name.url }}"/>

                                                </a>
                                            </div>
                                        </div>
                                        {% endfor %}
                                    </div>


                                </div>

                                <div class="col-md-4">
                                    <legend>Location</legend>
                                    <div id="map" class="map" style="height:400px;"></div>

                                    <br>
                                    {% if incident.is_validated == True %}
                                    <div ng-if="is_validated" class="alert alert-success">
                                        <strong>This incident is verified!</strong>
                                    </div>
                                    {% else %}
                                    <a  id="modal-336955" ng-click="get_user_location()" href="#modal-container-336955" role="button"
                                       class="btn btn-block btn-lg btn-warning" data-toggle="modal"><span
                                            class="glyphicon glyphicon-ok"></span> Confirm
                                    </a>
                                    {% endif %}
                                    <br>

                                    <a a id="modal-571346" href="#modal-container-571346" role="button"
                                       class="btn btn-block btn-lg btn-danger" data-toggle="modal"><span
                                            class="glyphicon glyphicon-remove"></span> Delete
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal fade" id="modal-container-336955" role="dialog" aria-labelledby="myModalLabel"
                 aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">

                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                                ×
                            </button>
                            <h4 class="modal-title" id="myModalLabel">
                                Confirm Incident
                            </h4>
                        </div>
                        <div class="modal-body">
                            <div class="clearfix"></div>
                            <!-- Text input-->

                            <form>{% csrf_token %}
                                <!--div class="form-group">
                                    <label class="col-md-4 control-label" for="textinput">Latitude</label>
                                    <div class="col-md-6">
                                        <input id="textinput" ng-model="latitude" name="textinput" type="text"
                                               placeholder=""
                                               class="form-control input-md">

                                    </div>
                                </div>

                                <div-- class="form-group">
                                    <label class="col-md-4 control-label" for="textinput">Longitude</label>
                                    <div class="col-md-6">
                                        <input id="textinput" ng-model="longitude" name="textinput" type="text"
                                               placeholder=""
                                               class="form-control input-md">

                                    </div>
                                </div-->
                                <div class="form-group">
                                    <label class="col-md-4 control-label" for="textinput">Address</label>
                                    <div class="col-md-6">
                                        <input id="textinput"  ng-model="address" name="textinput" type="text"
                                               placeholder=""
                                               class="form-control input-md">

                                    </div>
                                </div>
                                <div class="clearfix"></div>
                                <div class="clearfix"></div>
                                <!-- Textarea -->
                                <div class="form-group" style="margin-top:5px;">
                                    <label class="col-md-4 control-label" for="textarea">Comment</label>
                                    <div class="col-md-6">
                                    <textarea class="form-control" ng-model="comment" id="textarea"
                                              style="min-width: 100%"
                                              name="textarea"></textarea>
                                    </div>
                                </div>
                                <div class="clearfix"></div>

                                <!-- Textarea -->
                                <!--div class="form-group">
                                    <label class="col-md-4 control-label" for="textarea">Address</label>
                                    <div class="col-md-6">
                                        <textarea class="form-control" ng-model="address" id="textarea" style="min-width: 100%"
                                                  name="textarea"></textarea>
                                    </div>
                                </div-->
                                <div class="clearfix"></div>
                                <div class="form-group" style="margin-top:5px;">
                                    <label class="col-md-4 control-label" for="textarea">Address</label>
                                    <div class="col-md-6">
                                <button type="button" class="btn btn-default" data-dismiss="modal">
                                    Close
                                </button>
                                <button ng-click="validateIncident('{{ incident_id }}')" type="button"
                                        class="btn btn-primary">
                                    Confirm
                                </button>
                                        </div></div>
                            </form>
                        </div>
                        <div class="modal-footer">


                        </div>

                    </div>

                </div>

            </div>

            <div class="modal fade" id="modal-container-571346" role="dialog" aria-labelledby="myModalLabel"
                 aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">

                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                                ×
                            </button>
                            <h4 class="modal-title" id="myModalLabel">
                                Delete Incident
                            </h4>
                        </div>
                        <div class="modal-body">
                            Are you sure you want to delete this incident?
                        </div>
                        <div class="modal-footer">

                            <button type="button" ng-click="discardIncident('{{ incident_id }}')" id="delete"
                                    class="btn btn-warning" data-dismiss="modal">
                                YES
                            </button>
                            <button type="button" class="btn btn-primary">
                                NO
                            </button>
                        </div>
                    </div>

                </div>

            </div>

        </div>
        <!-- /page content -->

        <!-- footer content -->
        <footer>
            <div class="pull-right">
                CFR Developed by <a href="https://geoedge.lk">GeoEDGE</a>
            </div>
            <div class="clearfix"></div>
        </footer>
        <!-- /footer content -->
    </div>
</div>

<script>

    var validation_id = '{{ incident.is_validated }}';
</script>


<!-- Bootstrap -->
<script src="{% static 'incidents/vendors/bootstrap/dist/js/bootstrap.min.js' %}"></script>
<!-- FastClick -->
<script src="{% static 'incidents/vendors/fastclick/lib/fastclick.js' %}"></script>
<!-- NProgress -->
<script src="{% static 'incidents/vendors/nprogress/nprogress.js' %}"></script>

<!-- Custom Theme Scripts -->
<script src="{% static 'incidents/js/custom.js' %}"></script>
</body>
</html>
